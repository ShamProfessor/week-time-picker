# 周时间选择器组件共识文档

## 需求描述

开发一个「week-time-grid」组件，用于在网格界面上选择一周内的时间段。组件以7行（星期）× N列（小时及细分时间段）的形式展示，支持通过鼠标点击或拖动选择时间段，并输出标准化的时间范围数组。

## 功能规范

### 核心功能

1. **网格展示**：
   - 行表示星期（默认周一到周日）
   - 列表示时间段（可配置开始/结束小时和时间间隔）

2. **交互方式**：
   - 点击单元格：选中/取消选中该时间段
   - 拖动选择：从起始单元格拖动到结束单元格，选中/取消选中路径上的所有单元格

3. **数据绑定**：
   - Vue：使用 v-model 双向绑定
   - React：使用 value + onChange 模式

### 配置选项

1. **星期标签**：
   - 默认为周一到周日
   - 支持自定义标签文本

2. **时间范围**：
   - 默认为 0-23 小时
   - 支持自定义开始和结束小时（如 8-20）

3. **时间间隔**：
   - 默认为 1 小时
   - 支持自定义间隔（如 15 分钟、30 分钟等）
   - 时间间隔决定列数

### 数据格式

输出数据为对象数组，每个对象代表一个选中的时间段：

```typescript
interface TimeRange {
  dayOfWeek: number; // 0-6，表示周一到周日
  startTime: string; // 格式如 "HH:MM"，表示开始时间
  endTime: string;   // 格式如 "HH:MM"，表示结束时间
}
```

## 技术实现方案

### 架构设计

采用 monorepo 结构，使用 pnpm workspace 管理，分为三个包：

1. **@weektime-picker/core**：
   - 核心逻辑实现，无框架依赖
   - 使用 TypeScript 编写
   - 负责数据处理、状态管理和事件处理

2. **@weektime-picker/vue**：
   - Vue 3 组件封装
   - 调用 core 包的核心逻辑
   - 实现 v-model 双向绑定

3. **@weektime-picker/react**：
   - React 18 组件封装
   - 调用 core 包的核心逻辑
   - 实现 value + onChange 模式

### 技术约束

1. **开发语言**：TypeScript
2. **构建工具**：
   - Rollup 用于打包 core 包
   - Vite 用于开发和构建 Vue/React 组件
3. **样式方案**：使用 CSS Modules 或内联样式，避免样式冲突
4. **测试框架**：Jest 或 Vitest

### 集成方案

1. **发布到 npm**：
   - 三个包分别发布
   - 使用统一的版本号
   - 设置正确的依赖关系

2. **使用方式**：
   - Vue：`npm install @weektime-picker/vue`
   - React：`npm install @weektime-picker/react`

## 验收标准

1. **功能验收**：
   - 能够正确显示网格
   - 支持点击和拖动选择时间段
   - 支持自定义配置（星期标签、时间范围、时间间隔）
   - 输出符合规范的数据格式

2. **技术验收**：
   - 代码使用 TypeScript 编写，类型定义完整
   - 组件封装符合各框架的最佳实践
   - 核心逻辑与框架实现分离
   - 包结构清晰，依赖关系正确

3. **性能验收**：
   - 渲染性能良好，无明显卡顿
   - 内存占用合理
   - 事件处理高效

4. **兼容性验收**：
   - 支持主流浏览器
   - 在 Vue 3 和 React 18 环境中正常工作

## 任务边界限制

1. **不包含的功能**：
   - 不支持跨天的时间段选择
   - 不包含复杂的国际化处理
   - 不包含高级的辅助功能支持

2. **技术限制**：
   - 仅支持 Vue 3 和 React 18
   - 使用原生 DOM 操作，不依赖第三方 UI 库
   - 核心使用 div 实现，不使用 canvas 或其他复杂渲染方式